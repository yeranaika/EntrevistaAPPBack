{
	"info": {
		"_postman_id": "sistema-nivelacion-2025",
		"name": "EntrevistaAPP - Sistema de Nivelación Completo",
		"description": "Colección completa para probar el flujo de Onboarding y Tests de Nivelación",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "1. Auth",
			"item": [
				{
					"name": "Register",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    var jsonData = pm.response.json();",
									"    pm.environment.set(\"access_token\", jsonData.accessToken);",
									"    pm.environment.set(\"refresh_token\", jsonData.refreshToken);",
									"    console.log(\"Tokens guardados exitosamente\");",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"usuario@test.com\",\n  \"password\": \"Password123!\",\n  \"nombre\": \"Usuario Test\",\n  \"idioma\": \"es\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/auth/register",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"auth",
								"register"
							]
						},
						"description": "Registra un nuevo usuario y guarda los tokens automáticamente"
					},
					"response": []
				},
				{
					"name": "Login",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    var jsonData = pm.response.json();",
									"    pm.environment.set(\"access_token\", jsonData.accessToken);",
									"    pm.environment.set(\"refresh_token\", jsonData.refreshToken);",
									"    console.log(\"Tokens guardados exitosamente\");",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"usuario@test.com\",\n  \"password\": \"Password123!\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/auth/login",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"auth",
								"login"
							]
						},
						"description": "Inicia sesión y guarda los tokens automáticamente"
					},
					"response": []
				},
				{
					"name": "Refresh Token",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    var jsonData = pm.response.json();",
									"    pm.environment.set(\"access_token\", jsonData.accessToken);",
									"    console.log(\"Access token renovado\");",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"refreshToken\": \"{{refresh_token}}\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/auth/refresh",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"auth",
								"refresh"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "2. Onboarding",
			"item": [
				{
					"name": "POST - Guardar Onboarding",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{access_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"area\": \"Desarrollo\",\n  \"nivelExperiencia\": \"Junior\",\n  \"nombreCargo\": \"Desarrollador Full Stack\",\n  \"descripcionObjetivo\": \"Quiero trabajar en una startup de tecnología\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/onboarding",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"onboarding"
							]
						},
						"description": "Guarda la información inicial del usuario (área, nivel, objetivo)\n\n**Áreas disponibles:**\n- Desarrollo\n- Analista TI\n- Administracion\n- Ingenieria Informatica\n\n**Niveles:**\n- Junior (jr)\n- Semi Senior (mid)\n- Senior (sr)"
					},
					"response": []
				},
				{
					"name": "GET - Ver Estado de Onboarding",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{access_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/onboarding/status",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"onboarding",
								"status"
							]
						},
						"description": "Verifica si el usuario completó el onboarding"
					},
					"response": []
				},
				{
					"name": "GET - Obtener Información de Onboarding",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{access_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/onboarding",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"onboarding"
							]
						},
						"description": "Obtiene la información completa de onboarding del usuario"
					},
					"response": []
				}
			]
		},
		{
			"name": "3. Tests de Nivelación",
			"item": [
				{
					"name": "GET - Iniciar Test por Cargo",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    var jsonData = pm.response.json();",
									"    pm.environment.set(\"test_preguntas\", JSON.stringify(jsonData.preguntas));",
									"    pm.environment.set(\"test_cargo\", pm.request.url.query.get('cargo'));",
									"    console.log(\"Preguntas guardadas para evaluación\");",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{access_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/tests/nivelacion/iniciar?cargo=Desarrollador Full Stack&cantidad=10",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"tests",
								"nivelacion",
								"iniciar"
							],
							"query": [
								{
									"key": "cargo",
									"value": "Desarrollador Full Stack",
									"description": "Cargo de trabajo a evaluar"
								},
								{
									"key": "cantidad",
									"value": "10",
									"description": "Número de preguntas (default: 10)"
								}
							]
						},
						"description": "Obtiene un test con preguntas aleatorias balanceadas por cargo de trabajo (40% básicas, 40% intermedias, 20% avanzadas)\n\n**Ejemplos de cargos:**\n- Desarrollador Full Stack\n- Analista de Sistemas\n- Project Manager\n- DevOps Engineer\n- Data Analyst\n\n**Nota:** El cargo debe coincidir con el configurado en el onboarding (campo nombreCargo)"
					},
					"response": []
				},

				{
					"name": "POST - Evaluar Test",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    var jsonData = pm.response.json();",
									"    pm.environment.set(\"test_id\", jsonData.testId);",
									"    console.log(\"Test ID guardado: \" + jsonData.testId);",
									"    console.log(\"Puntaje: \" + jsonData.puntaje + \"%\");",
									"    console.log(\"Nivel: \" + jsonData.nivelSugerido);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{access_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"habilidad\": \"{{test_cargo}}\",\n  \"respuestas\": [\n    {\n      \"preguntaId\": \"REEMPLAZAR_CON_ID_PREGUNTA_1\",\n      \"respuestaSeleccionada\": 0\n    },\n    {\n      \"preguntaId\": \"REEMPLAZAR_CON_ID_PREGUNTA_2\",\n      \"respuestaSeleccionada\": 1\n    }\n  ]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/tests/nivelacion/evaluar",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"tests",
								"nivelacion",
								"evaluar"
							]
						},
						"description": "Evalúa las respuestas del test y devuelve:\n- Puntaje (0-100)\n- Nivel sugerido (básico, intermedio, avanzado)\n- Feedback personalizado\n- Detalle de cada respuesta\n\n**Nota:** El campo 'habilidad' ahora usa el cargo guardado automáticamente ({{test_cargo}})\n\n**Índices de respuesta:**\n- 0 = Primera opción (A)\n- 1 = Segunda opción (B)\n- 2 = Tercera opción (C)\n- 3 = Cuarta opción (D)\n\n**Criterios de evaluación:**\n- ≥ 80% → Avanzado\n- ≥ 60% → Intermedio\n- < 60% → Básico\n\n**Importante:** Reemplaza los IDs de pregunta con los obtenidos del endpoint 'Iniciar Test'"
					},
					"response": []
				},
				{
					"name": "GET - Ver Historial de Tests",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{access_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/tests/nivelacion/historial",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"tests",
								"nivelacion",
								"historial"
							]
						},
						"description": "Obtiene el historial completo de tests realizados por el usuario"
					},
					"response": []
				},
				{
					"name": "GET - Ver Historial por Cargo",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{access_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/tests/nivelacion/historial?cargo={{test_cargo}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"tests",
								"nivelacion",
								"historial"
							],
							"query": [
								{
									"key": "cargo",
									"value": "{{test_cargo}}",
									"description": "Filtrar por cargo específico"
								}
							]
						},
						"description": "Filtra el historial por un cargo específico (ej: 'Desarrollador Full Stack')"
					},
					"response": []
				},
				{
					"name": "GET - Ver Detalle de Test",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{access_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/tests/nivelacion/{{test_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"tests",
								"nivelacion",
								"{{test_id}}"
							]
						},
						"description": "Obtiene el detalle completo de un test específico"
					},
					"response": []
				}
			]
		},
		{
			"name": "4. Plan de Práctica",
			"item": [
				{
					"name": "POST - Generar Plan desde Test",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    var jsonData = pm.response.json();",
									"    pm.environment.set(\"plan_id\", jsonData.id);",
									"    console.log(\"Plan generado exitosamente\");",
									"    console.log(\"Plan ID: \" + jsonData.id);",
									"    console.log(\"Nivel: \" + jsonData.nivel);",
									"    console.log(\"Pasos: \" + jsonData.pasos.length);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{access_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"testNivelacionId\": \"{{test_id}}\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/plan-practica/generar-desde-test",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"plan-practica",
								"generar-desde-test"
							]
						},
						"description": "Genera un plan de práctica personalizado basado en el resultado del test de nivelación\n\n**Pasos generados según nivel:**\n- **Básico (jr)**: 4 pasos\n  1. Fundamentos\n  2. Práctica guiada\n  3. Proyecto simple\n  4. Preparación para entrevistas\n\n- **Intermedio (mid)**: 5 pasos\n  1. Fundamentos avanzados\n  2. Frameworks\n  3. Proyecto moderado\n  4. Patrones de diseño\n  5. Preparación para entrevistas\n\n- **Avanzado (sr)**: 6 pasos\n  1. Arquitectura\n  2. Optimización\n  3. Proyecto complejo\n  4. Liderazgo técnico\n  5. Preparación senior\n  6. Contribución open source"
					},
					"response": []
				},
				{
					"name": "GET - Ver Plan Actual",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{access_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/plan-practica",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"plan-practica"
							]
						},
						"description": "Obtiene el plan de práctica actual del usuario (si existe)"
					},
					"response": []
				}
			]
		},
		{
			"name": "5. Perfil de Usuario",
			"item": [
				{
					"name": "GET - Ver Mi Perfil",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{access_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/me",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"me"
							]
						},
						"description": "Obtiene información completa del usuario autenticado"
					},
					"response": []
				},
				{
					"name": "GET - Ver Mi Perfil Detallado",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{access_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/me/perfil",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"me",
								"perfil"
							]
						},
						"description": "Obtiene perfil detallado con área, nivel, objetivos, etc."
					},
					"response": []
				}
			]
		},
		{
			"name": "6. Historial Unificado",
			"item": [
				{
					"name": "GET - Historial Completo",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{access_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/historial",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"historial"
							]
						},
						"description": "Obtiene historial unificado de:\n- Tests de nivelación\n- Sesiones de entrevista\n\nOrdenado por fecha"
					},
					"response": []
				}
			]
		},
		{
			"name": "7. Health Check",
			"item": [
				{
					"name": "GET - Health",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/health",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"health"
							]
						},
						"description": "Verifica que el servidor esté funcionando correctamente"
					},
					"response": []
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:8080",
			"type": "string"
		}
	]
}
